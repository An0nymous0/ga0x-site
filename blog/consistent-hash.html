<!doctype html>
<html lang="zh-Hans" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">了解一致性哈希 | An0nymous</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://www.ga0x.com/blog/consistent-hash"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="了解一致性哈希 | An0nymous"><meta data-rh="true" name="description" content="了解一致性HASH之前我们先来了解下取模算法"><meta data-rh="true" property="og:description" content="了解一致性HASH之前我们先来了解下取模算法"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2020-07-27T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/an0nymous"><meta data-rh="true" property="article:tag" content="Java,算法"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://www.ga0x.com/blog/consistent-hash"><link data-rh="true" rel="alternate" href="https://www.ga0x.com/blog/consistent-hash" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://www.ga0x.com/blog/consistent-hash" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://LOUOXZQ42U-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="An0nymous RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="An0nymous Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-1FSHV9QKBM"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-1FSHV9QKBM",{anonymize_ip:!0})</script>


<link rel="search" type="application/opensearchdescription+xml" title="An0nymous" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.49693279.css">
<link rel="preload" href="/assets/js/runtime~main.b79f5a6b.js" as="script">
<link rel="preload" href="/assets/js/main.6725edc7.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">An0nymous</b></a><a class="navbar__item navbar__link" href="/docs/intro">笔记</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">文章</a><a class="navbar__item navbar__link" href="/devtools">Devtools开发工具</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/An0nymous0" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="最近博文导航"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2022/09/29/how-to-manage-multiple-java-versions-on-mac">macOS管理多个Java JDK 版本</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2022/09/26/macOS-Failed-to-run-java-gui">macOS运行Java GUI程序提示缺少字体或提示运行失败问题解决</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2022/09/21/JavaVM-FATAL-Failed-to-load-the-jvm-library">JavaVM FATAL: Failed to load the jvm library</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2022/07/14/cto-manage">今天很多 CTO 都是被干掉的，因为他没有成就业务</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2022/07/12/add-comments-to-docusaurus">在 Docusaurus 中添加评论系统</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="title_f1Hy" itemprop="headline">了解一致性哈希</h1><div class="container_mt6G margin-vert--md"><time datetime="2020-07-27T00:00:00.000Z" itemprop="datePublished">2020年7月27日</time> · <!-- -->阅读需 2 分钟</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/an0nymous" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/6836030?v=4" alt="xu gao"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/an0nymous" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">xu gao</span></a></div><small class="avatar__subtitle" itemprop="description">Full stack developer</small></div></div></div></div></header><div id="post-content" class="markdown" itemprop="articleBody"><p>了解一致性HASH之前我们先来了解下取模算法</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="举个例子">举个例子<a class="hash-link" href="#举个例子" title="标题的直接链接">​</a></h2><p>我们通常用到的Redis缓存，如果数据量较少一台Redis就搞定了。但是数据量大了，或者为了高可用可能就需要多台了。如果我们现在有4台Redis那么我们怎么能让数据尽量存储平均呢？</p><p>最简单的办法就是：
<strong>Hash(key) % N</strong>，key是要存储的数据，N是Redis的数量，在这里N=4。</p><p><img loading="lazy" alt="Alt text here" src="data:image/jpeg;base64,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" width="913" height="334" class="img_ev3q"></p><p>上面的方法看起来比较美好，但是一旦扩容就会遇到问题。假设说我们现在4台Redis不够用了要加一台那么我们的算法就变成了<strong>Hash(key) % 5</strong>；导致大部分key都会找不到。如果当前并发量比较大就会发生我们常说的<strong>缓存雪崩</strong>。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="一致性hash算法">一致性HASH算法<a class="hash-link" href="#一致性hash算法" title="标题的直接链接">​</a></h2><p>一致性HASH算法可以很好的解决我们上面出现问题，原理也是用取模的方法，不过一致性HASH算法是对<strong>2^32</strong>取模，简单来说一致性HASH是将哈希值形成一个圆环，范围是 0 - 2^32；整个HASH环如下</p><p><img loading="lazy" src="data:image/jpeg;base64,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tHbGO/m6rDja2VHXPpQAQeaMT80mcI2lRi64Kh8rl8+2cGK9xrs6wS169+dDJ/Y1A2VYS0q/GcdHI/6K9A6mxqC9TPwnHShcW5UQYY2EwsX4VEyT+OnMw0n2ipnrie3Q8c89VclR20rKBLq2Fi7wUOhjrECEml5bcNBmJLv06cF3go45wUJgRsABCTTDIdm5U/ol6MR6FGTFC5D3bVN4uCsARsuQFWZT1vUGg+jVuB7ULoqfHNJ5FX4F7VC0Hq1Ny+1YINsQ5Cux9q/uVf0PgAXc+Su0fWjEA/5L/9oADAMBAAIAAwAAABD77777777777r7rr77777777777777777777777647pr5b7777777777777777777777777+vH777777777777777777777777b3zQMwYr7777777777777777777xKcDzz/8A9fr02++++++++++++++3C/8A/wD/AN999999/qU6+++++++++++ZiA//AP8A/wB99999999vtK+++++++++d/wD/AP8A/wD/AP333333333/AP1A8888+++wf/8A/wD/AP8A/wD3333333333/8Am8888++//wD/AP8A/wD/AP8A/wDfffffffffffaaPvPPvvP/AP8A/wD/AP8A/wD/AH3333333333307Tzz63zz333333333333333333330CV7z7jzz333333333333333333330CD7z6L33333333333333333333330Cz7z4v33333333333333333333330B97z7f33333333333333333333330D/by7f33333333333333333333330D9bypP33333333333333333333330CP7z6733333333333333333333330B77z4Xz3333333333333333333330CX/8A+509999999999999999999999AN//wDrivfffffffffffffffffffffRnP8A/wC+MX99999999999999999999th/wD/AP77qkAAAAAAAAAAAAAAAAAAAA1z333774Lz/wD/AP8A/wD/AP8A/wD/AP8A/wD/AP8A/wBwS8999++++qx+/wD/AP8A/wD/AP8A/wD/AP8A/wD/AH6L7z33377774BzP/8A/wD/AP8A/wD/AP8A/wCfwGvvvPfffvvvvvPGuJvfdf8A/wD15WEI++++8999+++++88+/sBMh91lELM9+++++8999+++++88898+i+++8+++++++++8999//xAAeEQEAAgICAwEAAAAAAAAAAAABEUAAMBAgITFQYP/aAAgBAwEBPxD8OfmYvBtTwmSYhZ4TVcOJsi4s7Rw2miH44K4LFcZ7Ka689Vs+l0rr26Pu63W6/lwFkdRXHYVx3FUaUphOtojad43oxwmkOEU47gR8n//EAB4RAAMBAAICAwAAAAAAAAAAAAERQAAgMFBgEEFw/9oACAECAQE/EPRyWZWL4fSyylWWXQsoVWIT4cSkXHkLBaLR+Ii0UngKTxE55Cc83KekH0twPrcjzzzzzzz8T//EACsQAQABAQcCBgIDAQAAAAAAAAERACExQVBRYXFAgSAwkaHB8LHREOHxYP/aAAgBAQABPxD/AJCTU8EySrw4fwyBCq5jEASxvTFGYXPFaJIhQsLqu9wFuv8ACKIyg6bV9/ZTUJWgC9aGoClcRzA24mYJWofJQSWglP4RkQtZb6lThvkj8UNlaAOBYr7+ymizU3C+KCECVESyvzm0mYllwVN+vWExmJm84CChUKWYpfeKgFiWlmbwzkhW9GHSPJQ7QHYzABKA1aB+Ho3o7oCmkNR9Gp7zTXVowp4aqtj1Ki1k0pB7NQLxdysY840LxdppLHIhR8kajk8SA3pLDupYetXOGhl9aJJ3pTQLgOPNQbwaVZ3BRQ3edD817LFpRUiNTIjph0Ma+Txe1DJdVa9ulvb4yrNJqllNWtVidctMGLVle9/BSMp5R6m1hGhfVw3XLn7qLAdWMTsFxzQttBgdutv01T5qFAMPqAsCrAXtXoY2N4qDMHXogEoqGfdoYeTHpU8YU2kPqvNXEF2RQ45Hham7yadG8eBUEKB2+cl71uCl0xxV50KlwC9am5w/0yfAKv0KEXb0G+uxq1ymSDLuvzREgj5yTsGLQ0oAALAsyq30z97TzbXLbI3q8LVatXKxW6pG3Hffy32q1/U2uWxbt9YogkjaeU0FiwnTE0BBAWGXShcej5Wg67LL54iT2xKMrhtPITFmH7ogFwRmE18c8n18ibW4wcuYui57T/fjG4QmixdS75jqRhWtaW+Kwm8KBBmSlgwOHxLe5fHzmfd7u8U7ZHp/3M+CvvZ8+K3q1+MzNsYE0oEx8ChNCjG7b65nMLEipOxHgUc6hBbM0uulngs8dWOAzT7m/g9jXsM0+9v4LfKp+izS63V9/B7xT9BmfN1CJL73gSSGsDRT3ozKRGCa2LHh4nM4SjMrY0XqfEeP8H+5nGwKuI/s8VtuDh/uKnMjoBD58UF3pZzW6pmKkVxTheMvE1hdD2HMZ3gD9qEAMPHBGHoOYjSGHLf8eQF2hFM4n7mXzmipw38vJirvrmGXwZuvwPKuSBTK03LVvRLcGrVrkq1avl2Q3WHbWhEkuyy1pvsWvmNpbUJa09NqMqeKb3ShsoAjzUfa0NTmoN98pjgLlqVMzap1PPUqi3Wu1QGSBYHDJyahZht3GjoWVyPZpRzXOI4ZKeAUKGH7Oeje4zZwo5CI3l5kc47N6YjtOH+3SwrRXCk+ETxkM2KS4VZC9jh06ce+lY00Zac0ASWnWvtSs7OJXdtaO1L1e9VAplxXqI8MuPVmoGsYlWaLu+tACCw6yKIaNYvfVDQIGg/bpxvuY1ajH5PWrKB+cghiG9I5oAVwycL91ZArp0JVkN2lvbBR8cJQsHkq85vFKHarCm9n4H3qXyQUpBJpNQ1PHDWlIB3oHs1R60Cs+2woww0s1iu1b8sHhXJTgjwitBPFEcKk/wDCp/4VHFO9GOtGr6xXtGEf8l//2Q==" width="449" height="468" class="img_ev3q"></p><p>下一步是将我们的服务器进行HASH在环上找到自己的位置（可以是服务器+端口后对2^32取模），假设总共有4台服务，在环上的位置如下：</p><p><img loading="lazy" src="/assets/images/3-b7b97a7c1fc29a6808c6eb0158d4a8bb.jpg" width="714" height="727" class="img_ev3q"></p><p>接下来是如何让数据定位到具体的Node上。</p><p>假设我们有 A ，B ，C ，D四个数据对象经过HASH之后可能是环上的某一个定位但不是Node位置，那么怎么办呢，我们顺时针往下走遇到的第一个Node就是我们要存储的服务器，如下图所示：</p><p><img loading="lazy" src="/assets/images/4-fb31a4af0cb5d2adc584ca37954d8969.jpg" width="704" height="719" class="img_ev3q"></p><p>如果增加或删除服务器只会影响<strong>部分数据</strong></p><p>最后我们总结一致性HASH可以方便的增删服务并且只影响部分数据，注意：是解决了大部分数据问题，而不是所有。算是hash的增强。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="扩展阅读">扩展阅读<a class="hash-link" href="#扩展阅读" title="标题的直接链接">​</a></h2><p>数据量少的情况下我们会遇到数据倾斜，需要加虚拟节点。需要的同学可以自行查询相关资料。</p></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col"><b>标签：</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/java">Java</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/算法">算法</a></li></ul></div><div class="col margin-top--sm"><a href="https://github.com/An0nymous0/ga0x-site/tree/main/blog/2020-07-27-consistent-hash/index.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="博文分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/2020/07/28/centos7-install-nfs"><div class="pagination-nav__sublabel">较新一篇</div><div class="pagination-nav__label">CentOS 7 下 yum 安装和配置 NFS</div></a></nav><div style="margin-top:20px"></div></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#举个例子" class="table-of-contents__link toc-highlight">举个例子</a></li><li><a href="#一致性hash算法" class="table-of-contents__link toc-highlight">一致性HASH算法</a></li><li><a href="#扩展阅读" class="table-of-contents__link toc-highlight">扩展阅读</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/An0nymous0/ga0x-site/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog Discussions<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/An0nymous0" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.b79f5a6b.js"></script>
<script src="/assets/js/main.6725edc7.js"></script>
</body>
</html>